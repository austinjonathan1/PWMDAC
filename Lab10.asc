Version 4
SHEET 1 2752 824
WIRE 1232 -272 1184 -272
WIRE 1728 -272 1312 -272
WIRE 1184 -176 1184 -272
WIRE 1232 -176 1184 -176
WIRE 1408 -176 1392 -176
WIRE 1488 -176 1472 -176
WIRE 1648 -160 1632 -160
WIRE 1728 -160 1728 -272
WIRE 1728 -160 1712 -160
WIRE 944 -128 944 -144
WIRE 1024 -128 1024 -144
WIRE 1104 -128 1104 -176
WIRE 1184 -96 1184 -176
WIRE 1200 -96 1184 -96
WIRE 1312 -80 1312 -176
WIRE 1312 -80 1264 -80
WIRE 1392 -80 1392 -176
WIRE 1408 -80 1392 -80
WIRE 1200 -64 1184 -64
WIRE 1488 -64 1488 -176
WIRE 1488 -64 1472 -64
WIRE 1536 -64 1488 -64
WIRE 1632 -64 1632 -160
WIRE 1632 -64 1616 -64
WIRE 1648 -64 1632 -64
WIRE 1408 -48 1392 -48
WIRE 1728 -48 1728 -160
WIRE 1728 -48 1712 -48
WIRE 1744 -48 1728 -48
WIRE 1648 -32 1632 -32
WIRE 1392 -16 1392 -48
WIRE 1632 0 1632 -32
WIRE 1184 16 1184 -64
WIRE 1232 16 1184 16
WIRE 1488 16 1488 -64
WIRE 1488 16 1312 16
WIRE 1184 112 1184 96
WIRE 944 176 944 160
WIRE 1024 176 1024 160
WIRE 1104 176 1104 160
WIRE 544 336 480 336
WIRE 848 336 800 336
WIRE 896 336 848 336
WIRE 992 336 976 336
WIRE 480 352 480 336
WIRE 992 416 992 400
WIRE 480 448 480 432
WIRE 672 464 672 432
WIRE 848 464 848 416
WIRE 848 464 672 464
WIRE 1104 480 1104 464
WIRE 1200 480 1200 464
WIRE 1376 480 1376 464
WIRE 1584 480 1584 464
WIRE 848 560 848 544
FLAG 1024 -128 0
FLAG 944 -128 0
FLAG 1024 -224 V+
FLAG 944 -224 V-
FLAG 1232 -112 V+
FLAG 1232 -48 V-
FLAG 1440 -96 V+
FLAG 1440 -32 V-
FLAG 1392 -16 0
FLAG 1680 -80 V+
FLAG 1680 -16 V-
FLAG 1632 0 0
FLAG 1184 112 0
FLAG 1104 -128 0
FLAG 944 176 0
FLAG 944 80 CHECK
IOPIN 944 80 Out
FLAG 1024 176 0
FLAG 1024 80 IN
IOPIN 1024 80 In
FLAG 1744 -48 OUT
IOPIN 1744 -48 Out
FLAG 1104 176 0
FLAG 1104 80 PWM
IOPIN 1104 80 In
FLAG 1104 -64 IN
IOPIN 1104 -64 In
FLAG 1584 480 0
FLAG 1376 480 0
FLAG 1200 480 0
FLAG 1200 384 d[X]
IOPIN 1200 384 Out
FLAG 1376 384 d[OUT]
IOPIN 1376 384 Out
FLAG 1104 480 0
FLAG 1104 384 X
IOPIN 1104 384 In
FLAG 1584 384 d[CHECK]
IOPIN 1584 384 Out
FLAG 480 448 0
FLAG 848 560 0
FLAG 992 416 VP
IOPIN 992 416 Out
SYMBOL voltage 1024 -240 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage 944 -240 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value -5
SYMBOL res 1200 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RIN1
SYMATTR Value 100k
SYMBOL res 1168 0 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res 1328 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 1408 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL cap 1712 -176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 330pF
SYMBOL res 1632 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 3.57k
SYMBOL cap 1472 -192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 330pF
SYMBOL res 1328 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 1328 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 1200 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RD1
SYMATTR Value 100k
SYMBOL bv 944 64 R0
WINDOW 3 12 154 Left 2
SYMATTR Value V=V(IN) LAPLACE=((1.56*10^12)/(s^2+(1.78*10^6)*s+(1.56*10^12)))
SYMATTR InstName B1
SYMBOL voltage 1024 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 13 97 Left 2
SYMATTR Value AC 1
SYMATTR InstName V3
SYMBOL voltage 1104 64 R0
WINDOW 123 15 97 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 16 122 Left 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 1 0 1n 1n {TON_PWM} {T_PWM})
SYMATTR InstName V4
SYMBOL Opamps\\LT1815 1232 -80 R0
SYMATTR InstName U1
SYMBOL Opamps\\LT1815 1440 -64 R0
SYMATTR InstName U2
SYMBOL Opamps\\LT1815 1680 -48 R0
SYMATTR InstName U3
SYMBOL bv 1200 368 R0
SYMATTR InstName B2
SYMATTR Value V=ddt(V(X))
SYMBOL bv 1376 368 R0
SYMATTR InstName B3
SYMATTR Value V=ddt(V(OUT))
SYMBOL bv 1584 368 R0
SYMATTR InstName B4
SYMATTR Value V=ddt(V(CHECK))
SYMBOL voltage 1104 368 R0
WINDOW 3 22 150 Left 2
WINDOW 123 22 122 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 1 0 0.1m 0.1m 100)
SYMATTR Value2 AC 1
SYMATTR InstName V5
SYMBOL PowerProducts\\LT317A 672 336 R0
SYMATTR InstName U4
SYMBOL voltage 480 336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 9
SYMBOL res 832 320 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL res 832 448 R0
SYMATTR InstName R8
SYMATTR Value 300
SYMBOL res 992 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL LED 976 336 R0
SYMATTR InstName D1
TEXT 456 216 Left 2 !;ac dec 20 100 10meg
TEXT 456 -96 Left 2 !.param F_clock=16Meg\n.param T_clock=1/{F_clock}\n.param TS_MIN=0.01*{T_clock}\n.param TON_clock=0.5*{T_clock}\n.step dec param F_PWM=200k 1e6 10\n.param T_PWM=1/{F_PWM}\n.param TON_PWM=.5*{T_PWM}
TEXT 456 120 Left 2 !.MEAS TRAN ripple PP V(OUT)\n.MEAS TRAN  t2 AVG  V(OUT)
TEXT 456 184 Left 2 !.tran 0 20u 10u
TEXT 456 -128 Left 2 ;log (1/(ripple+f_pwm/16meg))/log(2)
TEXT 1064 -344 Left 2 ;2nd Order Butterworth DF2 Low Pass Filter
TEXT 1504 520 Left 2 !;tran 1000u
